See https://github.com/tensorflow/models/blob/master/official/mnist/mnist_tpu.py
